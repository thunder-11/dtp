<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile | ClubHub</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* Custom Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* slate-100 */
        }
        
        /* Gradient text for logo */
        .gradient-text {
            background: linear-gradient(to right, #4f46e5, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Hide elements by default */
        .edit-field,
        #save-btn,
        #cancel-btn {
            display: none;
        }
        
        /* Show elements when in edit mode */
        body.is-editing .edit-field {
            display: block;
        }
        body.is-editing #save-btn,
        body.is-editing #cancel-btn {
            display: inline-flex;
        }
        
        /* Hide view elements when in edit mode */
        body.is-editing .view-field {
            display: none;
        }
        body.is-editing #edit-btn {
            display: none;
        }
        
        /* Styling for the file input button */
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }
        
        .file-input-wrapper input[type=file] {
            font-size: 100px;
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
        }
        
        /* --- NEW STYLES FOR WIDGETS --- */
        
        /* Activity Dashboard Tabs */
        .tab-button {
            @apply pb-2 text-sm font-medium text-gray-500 border-b-2 border-transparent hover:text-gray-700 hover:border-gray-300;
        }
        .tab-button.active-tab {
            @apply text-indigo-600 border-indigo-600;
        }
        
        /* Calendar Styles */
        #calendar-grid-header, #calendar-grid-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.25rem;
            text-align: center;
        }
        #calendar-grid-header div {
            font-size: 0.75rem;
            color: #64748b; /* slate-500 */
            font-weight: 600;
        }
        .calendar-day {
            height: 2.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px;
            font-size: 0.875rem;
            position: relative;
            transition: background-color 0.2s;
        }
        .calendar-day.empty {
            pointer-events: none;
        }
        .calendar-day.event-day {
            background-color: #4f46e5;
            color: white;
            font-weight: 700;
            cursor: pointer;
        }
        .calendar-day.event-day .event-tooltip {
            position: absolute;
            bottom: 100%;
            margin-bottom: 0.5rem;
            width: max-content;
            max-width: 200px;
            background-color: #1e293b; /* slate-800 */
            color: white;
            font-size: 0.75rem;
            border-radius: 0.375rem;
            padding: 0.25rem 0.5rem;
            z-index: 10;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .calendar-day.event-day:hover .event-tooltip {
            opacity: 1;
        }
        .calendar-day:not(.event-day):not(.empty):hover {
            background-color: #f1f5f9; /* slate-100 */
        }
        
    </style>
</head>
<body class="bg-slate-100">

    <!-- Header Navigation -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
            <a href="#" class="gradient-text text-3xl font-bold">ClubHub</a>
            
            <div class="flex items-center space-x-4">
                <span class="font-medium text-gray-700 hidden sm:inline">Welcome, Alex!</span>
                <a href="#">
                    <img id="nav-avatar" class="w-10 h-10 rounded-full border-2 border-indigo-500 object-cover" src="https://placehold.co/100x100/4F46E5/FFFFFF?text=A" alt="User Avatar">
                </a>
            </div>
        </nav>
    </header>

    <!-- Main Content: Profile Page -->
    <main class="container mx-auto p-4 sm:p-6 lg:p-8">
        <div class="max-w-3xl mx-auto flex flex-col space-y-6">
            
            <!-- Left Column: Profile Card -->
            <div>
                <!-- Profile Card -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden relative">
                    
                    <!-- Edit Controls -->
                    <div class="absolute top-4 right-4 flex space-x-2 z-10">
                        <button id="edit-btn" class="w-10 h-10 flex items-center justify-center bg-indigo-50 text-indigo-600 rounded-full transition hover:bg-indigo-100" title="Edit Profile">
                            <i data-lucide="pencil" class="w-5 h-5"></i>
                        </button>
                        <button id="save-btn" class="w-10 h-10 flex items-center justify-center bg-green-100 text-green-700 rounded-full transition hover:bg-green-200" title="Save Changes">
                            <i data-lucide="check" class="w-5 h-5"></i>
                        </button>
                        <button id="cancel-btn" class="w-10 h-10 flex items-center justify-center bg-gray-100 text-gray-700 rounded-full transition hover:bg-gray-200" title="Cancel">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>

                    <!-- Profile Header -->
                    <div class="p-6 sm:p-8 flex flex-col sm:flex-row items-center sm:items-start sm:space-x-6">
                        <!-- Profile Picture -->
                        <div class="flex-shrink-0 relative">
                            <img id="profile-img" class="w-32 h-32 rounded-full object-cover shadow-md border-4 border-white" src="https://placehold.co/200x200/4F46E5/FFFFFF?text=A" alt="User Profile Picture">
                            
                            <!-- File input for changing photo -->
                            <span class="edit-field file-input-wrapper absolute bottom-1 right-1">
                                <label for="profile-picture-upload" class="w-10 h-10 flex items-center justify-center bg-indigo-600 text-white rounded-full transition hover:bg-indigo-700 cursor-pointer shadow-lg" title="Change photo">
                                    <i data-lucide="camera" class="w-5 h-5"></i>
                                </label>
                                <input id="profile-picture-upload" name="profile-picture-upload" type="file" accept="image/*">
                            </span>
                            
                             <!-- Hidden input to store image URL/data -->
                            <input type="hidden" id="profile-img-url" data-editable-field="profileImgUrl" value="https://placehold.co/200x200/4F46E5/FFFFFF?text=A">
                        </div>
                        
                        <!-- Profile Info -->
                        <div class="mt-4 sm:mt-2 text-center sm:text-left flex-grow w-full">
                            <!-- View State: Name -->
                            <h1 class="view-field text-3xl font-bold text-gray-900" data-editable-field="name">Alex Johnson</h1>
                            <!-- Edit State: Name -->
                            <input type="text" class="edit-field text-3xl font-bold text-gray-900 w-full p-2 border border-gray-300 rounded-lg" data-editable-input="name" value="Alex Johnson">
                            
                            <!-- View State: Major -->
                            <p class="view-field text-lg text-indigo-600 font-medium" data-editable-field="major">Computer Engineering, 2nd Year</p>
                            <!-- Edit State: Major -->
                            <input type="text" class="edit-field text-lg text-indigo-600 font-medium w-full p-2 border border-gray-300 rounded-lg mt-1" data-editable-input="major" value="Computer Engineering, 2nd Year">

                            <!-- View State: Bio -->
                            <p class="view-field text-gray-600 mt-2" data-editable-field="bio">President of the Tech Innovators Club. Passionate about AI and building the future. Exploring new ideas and connecting with fellow innovators.</p>
                            <!-- Edit State: Bio -->
                            <textarea class="edit-field text-gray-600 w-full p-2 border border-gray-300 rounded-lg mt-2" data-editable-input="bio" rows="4">President of the Tech Innovators Club. Passionate about AI and building the future. Exploring new ideas and connecting with fellow innovators.</textarea>
                        </div>
                    </div>
                    
                    <!-- Divider -->
                    <hr class="border-gray-200">
                    
                    <!-- Profile Details -->
                    <div class="p-6 sm:p-8 space-y-6">
                        <h2 class="text-xl font-semibold text-gray-800">Personal Information</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            
                            <!-- Email -->
                            <div>
                                <label class="block text-sm font-medium text-gray-500">Email Address</label>
                                <!-- View State: Email (Read-only) -->
                                <p class="view-field text-gray-800 text-lg font-medium" data-editable-field="email">alex.johnson@example.com</p>
                                <!-- Edit State: Email (Disabled) -->
                                <input type="email" class="edit-field text-gray-800 text-lg font-medium w-full p-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed" data-editable-input="email" value="alex.johnson@example.com" disabled>
                                <p class="edit-field text-xs text-gray-500 mt-1">Email address cannot be changed.</p>
                            </div>
                            
                            <!-- Phone -->
                            <div>
                                <label class="block text-sm font-medium text-gray-500">Phone Number</label>
                                <!-- View State: Phone -->
                                <p class="view-field text-gray-800 text-lg font-medium" data-editable-field="phone">+1 (555) 123-4567</p>
                                <!-- Edit State: Phone -->
                                <input type="tel" class="edit-field text-gray-800 text-lg font-medium w-full p-2 border border-gray-300 rounded-lg" data-editable-input="phone" value="+1 (555) 123-4567">
                            </div>
                            
                            <!-- Student ID -->
                            <div>
                                <label class="block text-sm font-medium text-gray-500">Student ID</label>
                                <!-- View State: Student ID -->
                                <p class="view-field text-gray-800 text-lg font-medium" data-editable-field="studentId">23CS10045</p>
                                <!-- Edit State: Student ID -->
                                <input type="text" class="edit-field text-gray-800 text-lg font-medium w-full p-2 border border-gray-300 rounded-lg" data-editable-input="studentId" value="23CS10045">
                            </div>
                            
                            <!-- LinkedIn Profile -->
                            <div>
                                <label class="block text-sm font-medium text-gray-500">LinkedIn Profile</label>
                                <!-- View State: LinkedIn -->
                                <a href="https://linkedin.com/in/alexjohnson" target="_blank" class="view-field text-indigo-600 text-lg font-medium break-all" data-editable-field="linkedin">linkedin.com/in/alexjohnson</a>
                                <!-- Edit State: LinkedIn -->
                                <input type="url" class="edit-field text-indigo-600 text-lg font-medium w-full p-2 border border-gray-300 rounded-lg" data-editable-input="linkedin" value="https://linkedin.com/in/alexjohnson">
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Column: Widgets (MOVED) -->
            
            <!-- My Activity Dashboard -->
            <section id="activity-dashboard" class="bg-white rounded-2xl shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">My Activity</h2>
                <div class="border-b border-gray-200">
                        <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                            <button data-tab="registered-events" class="tab-button active-tab">Events</button>
                            <button data-tab="my-clubs" class="tab-button">Clubs</button>
                            <button data-tab="event-history" class="tab-button">History</button>
                        </nav>
                    </div>
                <div id="activity-content" class="mt-4">
                    <!-- Content will be injected by JS -->
                </div>
            </section>
            
            <!-- My Calendar -->
            <section id="calendar-section" class="bg-white rounded-2xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">My Calendar</h2>
                        <div class="flex items-center">
                            <button id="prev-month-btn" class="p-1 rounded-full hover:bg-gray-100 text-gray-500">
                                <i data-lucide="chevron-left" class="w-5 h-5"></i>
                            </button>
                            <h3 id="month-year-display" class="text-base font-medium text-gray-700 w-28 text-center"></h3>
                            <button id="next-month-btn" class="p-1 rounded-full hover:bg-gray-100 text-gray-500">
                                <i data-lucide="chevron-right" class="w-5 h-5"></i>
                            </button>
                        </div>
                </div>
                <div id="calendar-container">
                    <div id="calendar-grid-header" class="mb-2"></div>
                    <div id="calendar-grid-days"></div>
                </div>
            </section>

        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize Lucide Icons
            lucide.createIcons();
            
            // --- INLINE EDITING LOGIC ---
            
            // Get buttons
            const editBtn = document.getElementById('edit-btn');
            const saveBtn = document.getElementById('save-btn');
            const cancelBtn = document.getElementById('cancel-btn');
            
            // Get image elements
            const profileImg = document.getElementById('profile-img');
            const navAvatar = document.getElementById('nav-avatar');
            const profileImgUrl = document.getElementById('profile-img-url');
            const profilePictureUpload = document.getElementById('profile-picture-upload');
            
            // Store all editable fields
            const editableFields = [
                'name', 'major', 'bio', 'email', 'phone', 
                'studentId', 'linkedin', 'profileImgUrl'
            ];
            
            let originalValues = {};

            // --- Function to Enter Edit Mode ---
            function enterEditMode() {
                originalValues = {};
                editableFields.forEach(field => {
                    const viewEl = document.querySelector(`[data-editable-field="${field}"]`);
                    const inputEl = document.querySelector(`[data-editable-input="${field}"]`);
                    
                    let value;
                    if (field === 'profileImgUrl') {
                        value = profileImgUrl.value;
                    } else if (field === 'linkedin') {
                        value = viewEl.href; // Get the href for links
                    } else {
                        value = viewEl.textContent;
                    }
                    originalValues[field] = value;
                    if (inputEl) inputEl.value = value;
                });
                document.body.classList.add('is-editing');
            }

            // --- Function to Exit Edit Mode ---
            function exitEditMode(saveChanges = false) {
                editableFields.forEach(field => {
                    const viewEl = document.querySelector(`[data-editable-field="${field}"]`);
                    const inputEl = document.querySelector(`[data-editable-input="${field}"]`);
                    
                    let value = saveChanges ? 
                        (field === 'profileImgUrl' ? profileImgUrl.value : inputEl.value) : 
                        originalValues[field];
                    
                    // Update view elements
                    if (field === 'profileImgUrl') {
                        profileImg.src = value;
                        navAvatar.src = value;
                        profileImgUrl.value = value;
                    } else if (field === 'linkedin') {
                        viewEl.textContent = value.replace(/^(https?:\/\/)?(www\.)?/, ''); // Clean display
                        viewEl.href = value;
                    } else {
                        viewEl.textContent = value;
                    }
                });
                document.body.classList.remove('is-editing');
            }
            
            // --- Handle Image Upload Preview ---
            profilePictureUpload.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const newImageUrl = e.target.result;
                        profileImg.src = newImageUrl;
                        profileImgUrl.value = newImageUrl;
                    }
                    reader.readAsDataURL(file);
                }
            });

            // --- Attach Edit Event Listeners ---
            editBtn.addEventListener('click', enterEditMode);
            saveBtn.addEventListener('click', () => exitEditMode(true));
            cancelBtn.addEventListener('click', () => exitEditMode(false));
            
            // --- ACTIVITY DASHBOARD LOGIC ---
            const activityContent = document.getElementById('activity-content');
            const tabButtons = document.querySelectorAll('button[data-tab]');
            
            const contentData = {
                'registered-events': `
                    <div class="space-y-3">
                        <div class="bg-slate-50 p-3 rounded-lg flex justify-between items-center">
                            <div>
                                <p class="font-medium text-gray-900">Annual Hackathon "CodeWave"</p>
                                <p class="text-sm text-gray-600">October 15, 2025</p>
                            </div>
                            <a href="#" class="text-indigo-600 text-sm font-medium">View</a>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-lg flex justify-between items-center">
                            <div>
                                <p class="font-medium text-gray-900">Digital Illustration Workshop</p>
                                <p class="text-sm text-gray-600">October 22, 2025</p>
                            </div>
                            <a href="#" class="text-indigo-600 text-sm font-medium">View</a>
                        </div>
                    </div>`,
                'my-clubs': `
                    <div class="grid grid-cols-2 gap-3">
                        <a href="#" class="flex flex-col items-center p-3 bg-slate-50 rounded-lg hover:bg-slate-100">
                            <i data-lucide="cpu" class="w-8 h-8 text-indigo-600"></i>
                            <p class="font-medium text-sm mt-1">Tech Titans</p>
                            <p class="text-xs text-gray-500">Member</p>
                        </a>
                        <a href="#" class="flex flex-col items-center p-3 bg-slate-50 rounded-lg hover:bg-slate-100">
                            <i data-lucide="lightbulb" class="w-8 h-8 text-yellow-500"></i>
                            <p class="font-medium text-sm mt-1">E-Cell</p>
                            <p class="text-xs text-gray-500">Member</p>
                        </a>
                    </div>`,
                'event-history': `
                     <div class="space-y-2 text-sm text-gray-600">
                         <p><span class="font-medium text-gray-800">Attended:</span> AI Seminar (Sep 15, 2025)</p>
                         <p><span class="font-medium text-gray-800">Attended:</span> Poetry Slam (Sep 2, 2025)</p>
                     </div>`
            };
            
            function renderActivityContent(tab) {
                if (activityContent) {
                    activityContent.innerHTML = contentData[tab];
                    lucide.createIcons(); // Re-run lucide to render new icons in 'my-clubs'
                }
            }
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active-tab'));
                    button.classList.add('active-tab');
                    renderActivityContent(button.dataset.tab);
                });
            });
            
            // Initial render for activity
            if (tabButtons.length > 0) {
                renderActivityContent('registered-events');
            }

            // --- CALENDAR LOGIC ---
            const calendarDaysContainer = document.getElementById('calendar-grid-days');
            const calendarHeaderContainer = document.getElementById('calendar-grid-header');
            const monthYearDisplay = document.getElementById('month-year-display');
            const prevMonthBtn = document.getElementById('prev-month-btn');
            const nextMonthBtn = document.getElementById('next-month-btn');

            // --- Your event data ---
            const registeredEventDetails = {
                '2025-10-15': 'Annual Hackathon "CodeWave"',
                '2025-10-22': 'Digital Illustration Workshop',
                '2025-11-05': 'Guest Lecture: AI Today'
            };

            let currentDate = new Date(2025, 9, 1); // Start at October 2025

            function generateCalendar(date) {
                if (!calendarDaysContainer || !monthYearDisplay) return;
                
                calendarDaysContainer.innerHTML = ''; // Clear old days
                calendarHeaderContainer.innerHTML = ''; // Clear old header
                
                const year = date.getFullYear();
                const month = date.getMonth();
                const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                const daysOfWeek = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];
                
                // Set month/year display
                monthYearDisplay.textContent = `${monthNames[month]} ${year}`;
                
                // Create Day of Week headers
                daysOfWeek.forEach(day => {
                    calendarHeaderContainer.innerHTML += `<div>${day}</div>`;
                });
                
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                // Add empty cells for days before the 1st
                for (let i = 0; i < firstDay; i++) { 
                    calendarDaysContainer.innerHTML += '<div class="calendar-day empty"></div>'; 
                }
                
                // Add cells for each day
                for (let day = 1; day <= daysInMonth; day++) {
                    const fullDateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    const eventTitle = registeredEventDetails[fullDateStr];
                    
                    if (eventTitle) {
                        calendarDaysContainer.innerHTML += `
                            <div class="calendar-day event-day">
                                ${day}
                                <div class="event-tooltip">${eventTitle}</div>
                            </div>`;
                    } else {
                        calendarDaysContainer.innerHTML += `<div class="calendar-day">${day}</div>`;
                    }
                }
            }

            if(prevMonthBtn) prevMonthBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                generateCalendar(currentDate);
            });
            
            if(nextMonthBtn) nextMonthBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                generateCalendar(currentDate);
            });
            
            // Initial calendar render
            generateCalendar(currentDate);

        });
    </script>
</body>
</html>



